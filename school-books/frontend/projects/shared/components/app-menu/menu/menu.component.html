<ul>
  <ng-container *ngFor="let menuItem of menuItems">
    <!-- selectable menu item -->
    <li *ngIf="!menuItem.menuItems && !menuItem.isSkeleton">
      <a
        class="group block py-2 cursor-pointer outline-offset-[-4px]"
        [class.pr-0.5]="!menuItem.isSelected"
        [class.pl-4]="level === 1"
        [class.pl-8]="level === 2"
        [class.pl-12]="level === 3"
        [routerLink]="menuItem.routeCommands"
        [relativeTo]="menuItem.routeExtras ? menuItem.routeExtras.relativeTo : undefined"
        [queryParams]="menuItem.routeExtras?.queryParams"
        [fragment]="menuItem.routeExtras?.fragment"
        [queryParamsHandling]="menuItem.routeExtras?.queryParamsHandling"
        [preserveFragment]="menuItem.routeExtras?.preserveFragment || false"
        [skipLocationChange]="menuItem.routeExtras?.skipLocationChange || false"
        [replaceUrl]="menuItem.routeExtras?.replaceUrl || false"
        [state]="menuItem.routeExtras?.state"
        [attr.aria-current]="menuItem.isSelected ? 'page' : null"
      >
        <fa-icon
          *ngIf="menuItem.icon"
          [icon]="menuItem.icon"
          class="mr-1"
          [ngClass]="!menuItem.isSelected ? 'text-gray-500 group-hover:text-blue-900' : 'text-primary'"
          size="lg"
        ></fa-icon>
        <span class="lg:text-sm" [ngClass]="!menuItem.isSelected ? '' : 'font-bold text-primary'">
          {{ menuItem.text }}
          <span *ngIf="menuItem.badge" class="sb-badge">
            {{ menuItem.badge }}
          </span>
        </span>
      </a>
    </li>

    <!-- menu item with inline children-->
    <li *ngIf="menuItem.menuItems && menuItem.showChildrenInline">
      <ng-template #menuItemContents>
        <fa-icon
          *ngIf="menuItem.icon"
          [icon]="menuItem.icon"
          class="mr-1"
          [ngClass]="!menuItem.isSelected ? 'text-gray-500 group-hover:text-blue-900' : 'text-primary'"
          size="lg"
        ></fa-icon>
        <span class="lg:text-sm">
          {{ menuItem.text }}
          <span *ngIf="menuItem.badge" class="sb-badge">
            {{ menuItem.badge }}
          </span>
        </span>

        <fa-icon class="p-1" [icon]="fasMinus"></fa-icon>
        <sb-inline-menu [menuItems]="menuItem.menuItems"></sb-inline-menu>
      </ng-template>

      <a
        *ngIf="!menuItem.routeCommands"
        class="group block py-2 pr-1 cursor-pointer"
        [class.pl-4]="level === 1"
        [class.pl-8]="level === 2"
        [class.pl-12]="level === 3"
      >
        <ng-container *ngTemplateOutlet="menuItemContents"></ng-container>
      </a>

      <a
        *ngIf="menuItem.routeCommands"
        class="group block py-2 pr-1 cursor-pointer outline-offset-[-4px]"
        [class.pl-4]="level === 1"
        [class.pl-8]="level === 2"
        [class.pl-12]="level === 3"
        [routerLink]="menuItem.routeCommands"
        [relativeTo]="menuItem.routeExtras ? menuItem.routeExtras.relativeTo : undefined"
        [queryParams]="menuItem.routeExtras?.queryParams"
        [fragment]="menuItem.routeExtras?.fragment"
        [queryParamsHandling]="menuItem.routeExtras?.queryParamsHandling"
        [preserveFragment]="menuItem.routeExtras?.preserveFragment || false"
        [skipLocationChange]="menuItem.routeExtras?.skipLocationChange || false"
        [replaceUrl]="menuItem.routeExtras?.replaceUrl || false"
        [state]="menuItem.routeExtras?.state"
      >
        <ng-container *ngTemplateOutlet="menuItemContents"></ng-container>
      </a>
    </li>

    <!-- menu item with children in normal flow-->
    <li
      *ngIf="menuItem.menuItems && !menuItem.showChildrenInline"
      class="overflow-hidden sb-parent-menu-item"
      [class.sb-parent-menu-item-open]="menuItem.isOpen"
    >
      <button
        type="button"
        class="group relative block py-2 pr-1 text-left w-full outline-offset-[-4px]"
        [class.pl-4]="level === 1"
        [class.pl-8]="level === 2"
        [class.pl-12]="level === 3"
        (click)="toggleOpen(menuItem)"
        [attr.aria-expanded]="menuItem.isOpen"
      >
        <fa-icon
          *ngIf="menuItem.icon"
          [icon]="menuItem.icon"
          class="mr-1"
          [ngClass]="!menuItem.isSelected ? 'text-gray-500 group-hover:text-blue-900' : 'text-primary'"
          size="lg"
        ></fa-icon>
        <span class="lg:text-sm">
          {{ menuItem.text }}
          <span *ngIf="menuItem.badge" class="sb-badge">
            {{ menuItem.badge }}
          </span>
        </span>
      </button>

      <sb-menu *ngIf="menuItem.isOpen" [menuItems]="menuItem.menuItems" [level]="level + 1"></sb-menu>
    </li>

    <!-- skeleton menu item -->
    <li *ngIf="menuItem.isSkeleton">
      <a class="flex items-center py-2 pr-1 pl-4">
        <span
          class="h-6 w-6 inline-block ml-0.5 mr-2 rounded-md align-middle sb-menu-skeleton sb-menu-skeleton-icon"
        ></span>
        <span class="h-4 w-40 inline-block rounded-md align-middle sb-menu-skeleton sb-menu-skeleton-text"></span>
      </a>
    </li>
  </ng-container>
</ul>
