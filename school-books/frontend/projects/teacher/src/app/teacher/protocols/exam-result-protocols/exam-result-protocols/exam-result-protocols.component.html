<sb-card>
  <ng-container card-title>Протоколи за резултати от изпити</ng-container>
  <ng-container card-body>
    <div [formGroup]="searchForm" novalidate class="sm:grid grid-cols-5 gap-x-4">
      <p class="col-start-1 col-span-full">Филтри</p>
      <sb-nom-select
        class="col-span-2"
        label="Вид на протокола"
        formControlName="protocolType"
        [nomService]="examResultProtocolTypeNomsService"
      ></sb-nom-select>
      <sb-text-field label="Номер на заповед" formControlName="orderNumber"></sb-text-field>
      <sb-text-field label="Номер на протокола" formControlName="protocolNumber"></sb-text-field>
      <sb-date-field label="Дата на протокола" formControlName="protocolDate"></sb-date-field>
    </div>

    <button type="button" *ngIf="canCreate" (click)="onClick()" mat-raised-button color="primary" class="mb-2.5">
      <fa-icon [icon]="fasPlus" size="lg"></fa-icon>
      <span>Нов протокол</span>
    </button>

    <sb-table
      [dataSource]="dataSource"
      [displayedColumns]="['action', 'protocolType', 'orderNumber', 'protocolNumber', 'protocolDate']"
    >
      <ng-container cdkColumnDef="action">
        <th cdk-header-cell *cdkHeaderCellDef></th>
        <td cdk-cell *cdkCellDef="let row" class="sb-table-action">
          <a
            [routerLink]="
              row.protocolType === 'Other'
                ? ['./', row.examResultProtocolId]
                : row.protocolType === 'Qualification'
                ? ['./qualification', row.examResultProtocolId]
                : row.protocolType === 'SkillsCheck'
                ? ['./skillsCheck', row.examResultProtocolId]
                : row.protocolType === 'QualificationAcquisition' ||
                  row.protocolType === 'QualificationAcquisitionExamGrades' ||
                  row.protocolType === 'QualificationAcquisitionStateExamGrades'
                ? ['./qualificationAcquisition', row.examResultProtocolId]
                : row.protocolType === 'HighSchoolCertificate'
                ? ['./highSchoolCertificate', row.examResultProtocolId]
                : row.protocolType === 'GraduationThesisDefense'
                ? ['./graduationThesisDefense', row.examResultProtocolId]
                : ['./', row.examResultProtocolId]
            "
            aria-label="Детайли"
            class="sb-link-btn"
          >
            <fa-icon [icon]="fadChevronCircleRight"></fa-icon>
          </a>
        </td>
      </ng-container>

      <ng-container cdkColumnDef="protocolType">
        <th cdk-header-cell *cdkHeaderCellDef>Вид на протокола</th>
        <td cdk-cell *cdkCellDef="let row">{{ row.protocolTypeName }}</td>
      </ng-container>

      <ng-container cdkColumnDef="orderNumber">
        <th cdk-header-cell *cdkHeaderCellDef>Номер на заповед</th>
        <td cdk-cell *cdkCellDef="let row">{{ row.orderNumber }}</td>
      </ng-container>

      <ng-container cdkColumnDef="protocolNumber">
        <th cdk-header-cell *cdkHeaderCellDef>Номер на протокола</th>
        <td cdk-cell *cdkCellDef="let row">{{ row.protocolNumber }}</td>
      </ng-container>

      <ng-container cdkColumnDef="protocolDate">
        <th cdk-header-cell *cdkHeaderCellDef>Дата на протокола</th>
        <td cdk-cell *cdkCellDef="let row">{{ row.protocolDate | sbDate }}</td>
      </ng-container>
    </sb-table>
  </ng-container>
</sb-card>
